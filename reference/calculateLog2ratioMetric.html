<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate metric using overlapping amplified/deleted regions — calculateLog2ratioMetric • CNVMetrics</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Calculate metric using overlapping amplified/deleted regions — calculateLog2ratioMetric" />
<meta property="og:description" content="Calculate a specific metric using overlapping 
amplified/deleted regions between to samples. The metric is calculated for
the amplified and deleted regions separately. When more than 2 samples are 
present, the metric is calculated for each sample pair." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CNVMetrics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/CNVMetrics.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/krasnitzlab/CNVMetrics/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate metric using overlapping amplified/deleted regions</h1>
    <small class="dont-index">Source: <a href='https://github.com/krasnitzlab/CNVMetrics/blob/master/R/CNVMetricsMethods.R'><code>R/CNVMetricsMethods.R</code></a></small>
    <div class="hidden name"><code>calculateLog2ratioMetric.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate a specific metric using overlapping 
amplified/deleted regions between to samples. The metric is calculated for
the amplified and deleted regions separately. When more than 2 samples are 
present, the metric is calculated for each sample pair.</p>
    </div>

    <pre class="usage"><span class='fu'>calculateLog2ratioMetric</span><span class='op'>(</span>
  <span class='va'>segmentData</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"weightedEuclideanDistance"</span><span class='op'>)</span>,
  minThreshold <span class='op'>=</span> <span class='fl'>0.2</span>,
  excludedRegions <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>segmentData</th>
      <td><p>a <code>GRangesList</code> that contains a collection of 
genomic ranges representing copy number events, including amplified/deleted 
status, from at least 2 samples. All samples must have a metadata column 
called '<code>log2ratio</code>' with the log2ratio values.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>a <code>character</code> string representing the metric to be used. 
This should be (an unambiguous abbreviation of) one of 
"weightedEuclideanDistance". Default: "weightedEuclideanDistance".</p></td>
    </tr>
    <tr>
      <th>minThreshold</th>
      <td><p>a single positive <code>numeric</code> setting the minimum 
value to consider two segments as different during the metric calculation. 
If the absolute difference is below or equal to threshold, the difference 
will be replaced by zero. Default: 0.2.</p></td>
    </tr>
    <tr>
      <th>excludedRegions</th>
      <td><p>an optional <code>GRanges</code> containing the regions 
that have to be excluded for the metric calculation. Default: <code>NULL</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an object of class "<code>CNVMetric</code>" which contains the calculated
metric. This object is a list with the following components:</p><ul>
<li><p><code>LOG2RATIO</code> a lower-triangular <code>matrix</code> with the 
    results of the selected metric on the log2ratio values for each paired
    samples. The value <code>NA</code> is present when the metric cannot be 
    calculated. The value <code>NA</code> is also present in the top-triangular 
    section, as well as the diagonal, of the matrix.</p></li>
</ul>

<p>The object has the following attributes (besides "class" equal 
to "CNVMetric"):</p><ul>
<li><p><code>metric</code> the metric used for the calculation.</p></li>
<li><p><code>names</code> the names of the two matrix containing the metrics for
the amplified and deleted regions.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The weighted euclidean distance is 
\((\sum((x_i - y_i)^2 * log(nbrBases_i))^0.5\) 
where <code>x</code> and <code>y</code> are the
values of 2 samples for a specific segment <code>i</code> and <code>nbrBases</code> the 
number of bases of the segment <code>i</code>.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Astrid Deschênes, Pascal Belleau</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Load required package to generate the samples</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://bioconductor.org/packages/GenomicRanges'>GenomicRanges</a></span><span class='op'>)</span>

<span class='co'>## Create a GRangesList object with 3 samples</span>
<span class='co'>## The stand of the regions doesn't affect the calculation of the metric</span>
<span class='va'>demo</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/GenomicRanges/man/GRangesList-class.html'>GRangesList</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>demo</span><span class='op'>[[</span><span class='st'>"sample01"</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html'>GRanges</a></span><span class='op'>(</span>seqnames <span class='op'>=</span> <span class='st'>"chr1"</span>, 
    ranges <span class='op'>=</span>  <span class='fu'>IRanges</span><span class='op'>(</span>start <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1905048</span>, <span class='fl'>4554832</span>, <span class='fl'>31686841</span><span class='op'>)</span>, 
    end <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2004603</span>, <span class='fl'>4577608</span>, <span class='fl'>31695808</span><span class='op'>)</span><span class='op'>)</span>, strand <span class='op'>=</span>  <span class='st'>"*"</span>,
    log2ratio <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2.5555</span>, <span class='fl'>1.9932</span>, <span class='op'>-</span><span class='fl'>0.9999</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>demo</span><span class='op'>[[</span><span class='st'>"sample02"</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html'>GRanges</a></span><span class='op'>(</span>seqnames <span class='op'>=</span> <span class='st'>"chr1"</span>, 
    ranges <span class='op'>=</span>  <span class='fu'>IRanges</span><span class='op'>(</span>start <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1995066</span>, <span class='fl'>31611222</span>, <span class='fl'>31690000</span><span class='op'>)</span>, 
    end <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2204505</span>, <span class='fl'>31689898</span>, <span class='fl'>31895666</span><span class='op'>)</span><span class='op'>)</span>, strand <span class='op'>=</span>  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"-"</span>, <span class='st'>"+"</span>, <span class='st'>"+"</span><span class='op'>)</span>,
    log2ratio <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.3422</span>, <span class='fl'>0.5454</span>, <span class='op'>-</span><span class='fl'>1.4444</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## The amplified region in sample03 is a subset of the amplified regions </span>
<span class='co'>## in sample01</span>
<span class='va'>demo</span><span class='op'>[[</span><span class='st'>"sample03"</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html'>GRanges</a></span><span class='op'>(</span>seqnames <span class='op'>=</span> <span class='st'>"chr1"</span>, 
    ranges <span class='op'>=</span>  <span class='fu'>IRanges</span><span class='op'>(</span>start <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1906069</span>, <span class='fl'>4558838</span><span class='op'>)</span>, 
    end <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1909505</span>, <span class='fl'>4570601</span><span class='op'>)</span><span class='op'>)</span>, strand <span class='op'>=</span>  <span class='st'>"*"</span>,
    log2ratio <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3.2222</span>, <span class='op'>-</span><span class='fl'>1.3232</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## Calculating Sorensen metric</span>
<span class='fu'>calculateLog2ratioMetric</span><span class='op'>(</span><span class='va'>demo</span>, method<span class='op'>=</span><span class='st'>"weightedEuclideanDistance"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; CNV Metrics
#&gt; Metric:
#&gt; weightedEuclideanDistance
#&gt; 
#&gt; LOG2RATIO:
#&gt;            sample01 sample02 sample03
#&gt; sample01         NA       NA       NA
#&gt; sample02 0.06414725       NA       NA
#&gt; sample03 0.07458553       NA       NA
#&gt; </div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Astrid Deschênes, Pascal Belleau, Alexander Krasnitz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


