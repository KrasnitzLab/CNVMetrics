<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate metric using overlapping amplified/deleted regions between 
two samples. — calculateOneOverlapMetric • CNVMetrics</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Calculate metric using overlapping amplified/deleted regions between 
two samples. — calculateOneOverlapMetric" />
<meta property="og:description" content="Calculate a specific metric using overlapping 
amplified/deleted regions between two samples." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CNVMetrics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/CNVMetrics.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/krasnitzlab/CNVMetrics/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate metric using overlapping amplified/deleted regions between 
two samples.</h1>
    <small class="dont-index">Source: <a href='https://github.com/krasnitzlab/CNVMetrics/blob/master/R/CNVMetricsOverlapInternalMethods.R'><code>R/CNVMetricsOverlapInternalMethods.R</code></a></small>
    <div class="hidden name"><code>calculateOneOverlapMetric.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate a specific metric using overlapping 
amplified/deleted regions between two samples.</p>
    </div>

    <pre class="usage"><span class='fu'>calculateOneOverlapMetric</span><span class='op'>(</span><span class='va'>sample01</span>, <span class='va'>sample02</span>, <span class='va'>method</span>, <span class='va'>type</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>sample01</th>
      <td><p>a <code>GRanges</code> which contains a collection of 
genomic ranges representing copy number events for the first sample. 
The <code>GRanges</code> must have a metadata column called '<code>state</code>' with 
amplified regions identified as '<code>AMPLIFICATION</code>' and 
deleted regions identified as '<code>DELETION</code>'; regions with different 
identifications will not be used in the
calculation of the metric.</p></td>
    </tr>
    <tr>
      <th>sample02</th>
      <td><p>a <code>GRanges</code> which contains a collection of 
genomic ranges representing copy number events for the second sample.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>a <code>character</code> string representing the metric to be
used ('<code>sorensen</code>' or '<code>szymkiewicz</code>'.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>a <code>character</code> string representing the type of 
copy number events to be used ('<code>AMPLIFICATION</code>' or '<code>DELETION</code>').</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a <code>numeric</code>, the value of the specified metric. If
the metric cannot be calculated, <code>NA</code> is returned.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The method calculates a specified metric using overlapping
regions between the samples. Only regions corresponding to the type
specified by user are used in the calculation of the metric. The strand of 
the regions is not taken into account while
calculating the metric.</p>
<p>The Sorensen metric is calculated by dividing twice the size of 
the intersection by the sum of the size of the two sets. If the sum of
the size of the two sets is zero; the value <code>NA</code> is
returned instead.</p>
<p>The Szymkiewicz-Simpson metric is calculated by dividing the size of 
the intersection by the smaller of the size of the two sets. If one sample
has a size of zero, the metric is not calculated; the value <code>NA</code> is
returned instead.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Sørensen, Thorvald. n.d. “A Method of Establishing Groups of Equal 
Amplitude in Plant Sociology Based on Similarity of Species and Its 
Application to Analyses of the Vegetation on Danish Commons.” 
Biologiske Skrifter, no. 5: 1–34.</p>
<p>Vijaymeena, M. K, and Kavitha K. 2016. “A Survey on Similarity Measures in 
Text Mining.” Machine Learning and Applications: An International 
Journal 3 (1): 19–28. doi: <a href='https://doi.org/10.5121/mlaij.2016.3103'>https://doi.org/10.5121/mlaij.2016.3103</a></p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Astrid Deschênes</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Load required package to generate the two samples</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://bioconductor.org/packages/GenomicRanges'>GenomicRanges</a></span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Loading required package: GenomicRanges</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: stats4</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: BiocGenerics</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: parallel</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘BiocGenerics’</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:parallel’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,</span>
#&gt; <span class='message'>    clusterExport, clusterMap, parApply, parCapply, parLapply,</span>
#&gt; <span class='message'>    parLapplyLB, parRapply, parSapply, parSapplyLB</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:stats’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    IQR, mad, sd, var, xtabs</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:base’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    anyDuplicated, append, as.data.frame, basename, cbind, colnames,</span>
#&gt; <span class='message'>    dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,</span>
#&gt; <span class='message'>    grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,</span>
#&gt; <span class='message'>    order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,</span>
#&gt; <span class='message'>    rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,</span>
#&gt; <span class='message'>    union, unique, unsplit, which.max, which.min</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: S4Vectors</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘S4Vectors’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:base’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    expand.grid</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: IRanges</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: GenomeInfoDb</span></div><div class='input'>
<span class='co'>## Generate two samples with identical sequence levels</span>
<span class='va'>sample01</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html'>GRanges</a></span><span class='op'>(</span>seqnames <span class='op'>=</span> <span class='st'>"chr1"</span>, 
    ranges <span class='op'>=</span>  <span class='fu'>IRanges</span><span class='op'>(</span>start <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>100</span>, <span class='fl'>201</span>, <span class='fl'>400</span><span class='op'>)</span>, 
    end <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>200</span>, <span class='fl'>350</span>, <span class='fl'>500</span><span class='op'>)</span><span class='op'>)</span>, strand <span class='op'>=</span>  <span class='st'>"*"</span>,
    state <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"AMPLIFICATION"</span>, <span class='st'>"AMPLIFICATION"</span>, <span class='st'>"DELETION"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>sample02</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html'>GRanges</a></span><span class='op'>(</span>seqnames <span class='op'>=</span> <span class='st'>"chr1"</span>, 
    ranges <span class='op'>=</span>  <span class='fu'>IRanges</span><span class='op'>(</span>start <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>150</span>, <span class='fl'>200</span>, <span class='fl'>450</span><span class='op'>)</span>, 
    end <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>250</span>, <span class='fl'>350</span>, <span class='fl'>500</span><span class='op'>)</span><span class='op'>)</span>, strand <span class='op'>=</span>  <span class='st'>"*"</span>,
    state <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"AMPLIFICATION"</span>, <span class='st'>"DELETION"</span>, <span class='st'>"DELETION"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## Calculate Sorensen metric for the amplified regions   </span>
<span class='fu'>CNVMetrics</span><span class='fu'>:::</span><span class='fu'>calculateOneOverlapMetric</span><span class='op'>(</span><span class='va'>sample01</span>, <span class='va'>sample02</span>, 
    method<span class='op'>=</span><span class='st'>"sorensen"</span>, type<span class='op'>=</span><span class='st'>"AMPLIFICATION"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.5738636</div><div class='input'>
<span class='co'>## Calculate Szymkiewicz-Simpson metric for the amplified regions   </span>
<span class='co'>## Amplified regions of sample02 are a subset of the amplified </span>
<span class='co'>## regions in sample01</span>
<span class='fu'>CNVMetrics</span><span class='fu'>:::</span><span class='fu'>calculateOneOverlapMetric</span><span class='op'>(</span><span class='va'>sample01</span>, <span class='va'>sample02</span>, 
    method<span class='op'>=</span><span class='st'>"szymkiewicz"</span>, type<span class='op'>=</span><span class='st'>"AMPLIFICATION"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 1</div><div class='input'>
<span class='co'>## Calculate Sorensen metric for the deleted regions   </span>
<span class='fu'>CNVMetrics</span><span class='fu'>:::</span><span class='fu'>calculateOneOverlapMetric</span><span class='op'>(</span><span class='va'>sample01</span>, <span class='va'>sample02</span>, 
    method<span class='op'>=</span><span class='st'>"sorensen"</span>, type<span class='op'>=</span><span class='st'>"DELETION"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.3366337</div><div class='input'>    
<span class='co'>## Calculate Szymkiewicz-Simpson metric for the deleted regions    </span>
<span class='fu'>CNVMetrics</span><span class='fu'>:::</span><span class='fu'>calculateOneOverlapMetric</span><span class='op'>(</span><span class='va'>sample01</span>, <span class='va'>sample02</span>,
    method<span class='op'>=</span><span class='st'>"szymkiewicz"</span>, type<span class='op'>=</span><span class='st'>"DELETION"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.5049505</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Astrid Deschênes, Pascal Belleau, Alexander Krasnitz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


