<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Generates a simulation for one chromosome — processChr • CNVMetrics</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Generates a simulation for one chromosome — processChr"><meta property="og:description" content="TODO"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CNVMetrics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.15.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/CNVMetrics.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/krasnitzlab/CNVMetrics/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generates a simulation for one chromosome</h1>
    <small class="dont-index">Source: <a href="https://github.com/krasnitzlab/CNVMetrics/blob/master/R/CNVMetricsSimulations.R" class="external-link"><code>R/CNVMetricsSimulations.R</code></a></small>
    <div class="hidden name"><code>processChr.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>TODO</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">processChr</span><span class="op">(</span><span class="va">curSample</span>, <span class="va">simChr</span>, <span class="va">chrCur</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-cursample">curSample<a class="anchor" aria-label="anchor" href="#arg-cursample"></a></dt>
<dd><p>a <code>GRanges</code> that contains a collection of
genomic ranges representing copy number events, including amplified/deleted
status, from one sample. The sample must have a metadata column
called '<code>state</code>' with a state, in an character string format,
specified for each region (ex: DELETION, LOH, AMPLIFICATION, NEUTRAL, etc.)
and a metadata column called '<code>CN</code>' that contains the log2 copy
number ratios.</p></dd>


<dt id="arg-simchr">simChr<a class="anchor" aria-label="anchor" href="#arg-simchr"></a></dt>
<dd><p>a <code>data.frame</code> containing the information from one
simulated chromosome (shuffled segments). The starting position and the
ending position of the segments should be between zero and one. The segment
width is representing the proportional size of the segment relative to the
global segment size for the chromosome. The <code>data.frame</code> columns names
should be: 'ID', 'chr', 'start', 'end', 'log2ratio', 'state'.</p></dd>


<dt id="arg-chrcur">chrCur<a class="anchor" aria-label="anchor" href="#arg-chrcur"></a></dt>
<dd><p>a <code>character</code> string representing the name of the
chromosome.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>a <code>data.frame</code> containing the simulation for the specified
chromosome.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Astrid Deschênes, Pascal Belleau</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Load required package to generate the samples</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/GenomicRanges" class="external-link">GenomicRanges</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create one 'demo' genome with 2 chromosomes and few segments</span></span></span>
<span class="r-in"><span><span class="co">## The stand of the regions doesn't affect the calculation of the metric</span></span></span>
<span class="r-in"><span><span class="va">sample01</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span>seqnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"chr2"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ranges<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/IRanges-constructor.html" class="external-link">IRanges</a></span><span class="op">(</span>start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1905048</span>, <span class="fl">4554832</span>, <span class="fl">31686841</span>, <span class="fl">32686222</span>,</span></span>
<span class="r-in"><span>        <span class="fl">1</span>, <span class="fl">120331</span>, <span class="fl">725531</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    end<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2004603</span>, <span class="fl">4577608</span>, <span class="fl">31695808</span>, <span class="fl">32689222</span>, <span class="fl">117121</span>,</span></span>
<span class="r-in"><span>        <span class="fl">325555</span>, <span class="fl">1225582</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    strand<span class="op">=</span><span class="st">"*"</span>,</span></span>
<span class="r-in"><span>    state<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AMPLIFICATION"</span>, <span class="st">"NEUTRAL"</span>, <span class="st">"DELETION"</span>, <span class="st">"LOH"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"DELETION"</span>, <span class="st">"NEUTRAL"</span>, <span class="st">"NEUTRAL"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    log2ratio<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5849625</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">0.87777</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The simulated chromosome with shuffled segment</span></span></span>
<span class="r-in"><span><span class="co">## The simulated chromosome can be a different chromosome</span></span></span>
<span class="r-in"><span><span class="va">simulatedChr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"S4"</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    chr<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"chr2"</span>, <span class="fl">4</span><span class="op">)</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.02515227</span>, <span class="fl">0.09360992</span>, <span class="fl">0.25903561</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    end<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.02515227</span>, <span class="fl">0.09360992</span>, <span class="fl">0.25903561</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    log2ratio<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.0</span>, <span class="op">-</span><span class="fl">0.9999</span>, <span class="fl">0.0</span>, <span class="fl">0.5843</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    state<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LOH"</span>, <span class="st">"DELETION"</span>, <span class="st">"NEUTRAL"</span>, <span class="st">"AMPLIFICATION"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Generates a simulation for chromosome 1 using a simulated chromosome</span></span></span>
<span class="r-in"><span><span class="co">## The segments from the simulated chromosome will be positioned on the</span></span></span>
<span class="r-in"><span><span class="co">## chromosome 1 after resizing for the size of chromosome 1.</span></span></span>
<span class="r-in"><span><span class="co">## The spaces between the segments in chromosome 1 will be</span></span></span>
<span class="r-in"><span><span class="co">## preserved.</span></span></span>
<span class="r-in"><span><span class="fu">CNVMetrics</span><span class="fu">:::</span><span class="fu">processChr</span><span class="op">(</span>curSample<span class="op">=</span><span class="va">sample01</span>, simChr<span class="op">=</span><span class="va">simulatedChr</span>,</span></span>
<span class="r-in"><span>    chrCur<span class="op">=</span><span class="st">"chr1"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ID  chr    start      end log2ratio         state</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    S4 chr1  1905048  1908426   -1.0000           LOH</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    S4 chr1  1908427  1917620   -0.9999      DELETION</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    S4 chr1  1917621  1939837    0.0000       NEUTRAL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    S4 chr1  1939838  2004603    0.5843 AMPLIFICATION</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41   S4 chr1  4554832  4577608    0.5843 AMPLIFICATION</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 411  S4 chr1 31686841 31695808    0.5843 AMPLIFICATION</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4111 S4 chr1 32686222 32689226    0.5843 AMPLIFICATION</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Astrid Deschênes, Pascal Belleau, David A. Tuveson, Alexander Krasnitz.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

